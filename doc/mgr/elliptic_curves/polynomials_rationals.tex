\section{Wielomiany i funkcje wymierne}

Wielomiany i funkcje wymierne nad krzywymi eliptycznymi
różnią się pod pewnymi względami od swoich klasycznych odpowiedników.
Ponieważ nasze rozważania w dalszej części pracy
będą nieustannie dotyczyć wielomianów i funkcji wymiernych,
przeanalizujemy teraz te pojęcia.

\subsection*{Definicja wyrażenia wielomianowego}

Przyjmujemy następującą definicję
wyrażenia wielomianowego nad krzywą eliptyczną.

\begin{definition}
\emph{Wyrażenie wielomianowe nad krzywą eliptyczną $E(\K)$}
to element pierścienia ilorazowego
$\K[x,y]/(\kappa - y^2)$.
\end{definition}

Sens powyższej definicji jest następujący.
Dowolna krzywa eliptyczna nad ciałem $\K$ to podzbiór zbioru $\K \times \K$
(nie licząc punktu w nieskończoności),
dlatego pierwszym kandydatem na pierścień wyrażeń wielomianowych
jest pierścień $\K[x,y]$.
Współrzędne skończonych punktów krzywej spełniają równanie krzywej,
dlatego też wielomiany dwóch zmiennych różniące się
o wielokrotność wielomianu $\kappa- y^2$
dadzą tę samą funkcję wielomianową.
Stąd pierścień $\K[x,y]$ dzielimy przez ideał $(\kappa- y^2)$
i uzyskujemy pierścień ilorazowy $K[x,y]/(\kappa - y^2)$.

Wyrażenie wielomianowe nad krzywą eliptyczną
jest w takim razie klasą abstrakcji
pewnej relacji równoważności na zbiorze wielomianów dwóch zmiennych.
Nie jest wygodnie myśleć o wyrażeniach wielomianowych w ten sposób.
Następujący lemat pokazuje,
w jaki sposób wybrać reprezentantów klas abstrakcji
do dalszych rozważań.

\begin{theorem}
Dana jest krzywa eliptyczna $E(\K)$.
Niech $f \in \K[x,y]$
będzie wielomianem dwóch zmiennych nad ciałem $\K$.
Wówczas istnieje taki wielomian $g \in \K[x,y]$,
że $g = u + yv$, gdzie $u, v \in \K[x]$
oraz $g$ różni się od $f$ o wielokrotność $\kappa - y^2$.
Ponadto, wielomian $g$ jest wyznaczony jednoznacznie.
\end{theorem}

\begin{remark}
Pierścień wyrażeń wielomianowych nad krzywą eliptyczną $E(\K)$
będziemy odtąd utożsamiać ze zbiorem
złożonym z wielomianów postaci $u + yv$,
gdzie $u, v \in \K[x]$.
Zbiór ten będziemy oznaczać $(1 + y)\K[x]$.
\end{remark}

Zwróćmy uwagę, że zbiór $(1 + y)\K[x]$ nie ma struktury pierścienia,
ponieważ nie jest określone mnożenie.
Nie jest to problem,
ponieważ z kontekstu zawsze będzie wynikało,
nad jaką krzywą rozpatrywane są wyrażenia wielomianowe.
Co więcej, czasami wystarczy,
że w miejsce powstałego podczas mnożenia czynnika $y^2$
będziemy podstawiać symbol $\kappa$
i nie będzie nam potrzebna dokładna znajomość parametrów krzywej $A$ oraz $B$.

\begin{remark}
W zależności od kontekstu wielomian charakterystyczny krzywej eliptycznej
będziemy traktować jak wielomian jednej zmiennej, wielomian dwóch zmiennych
lub jak wyrażenie wielomianowe nad krzywą eliptyczną.
\end{remark}

\subsection*{Definicja wyrażenia wymiernego}

Przyjmujemy następującą definicję
wyrażenia wymiernego nad krzywą eliptyczną.

\begin{definition}
\emph{Wyrażenie wymierne nad krzywą eliptyczną}
to element ciała ułamków pierścienia wyrażeń wielomianowych nad tą krzywą.
\end{definition}

Sens tej definicji jest taki sam,
jak w przypadku każdego innego ciała ułamków --
bierzemy zbiór ułamków formalnych $\frac{f}{g}$,
gdzie $f$ i $g$ to wyrażenia wielomianowe nad krzywą eliptyczną,
po czym utożsamiamy ułamki $\frac{f_1}{g_1}$ oraz $\frac{f_2}{g_2}$,
jeżeli zachodzi równość wyrażeń $f_1g_2 = f_2g_1$.

\begin{fact}
Zbiór wyrażeń wielomianowych można zanużyć w zbiorze wyrażeń wymiernych,
przypisując wyrażeniu wielomianowemu $f$ wyrażenie wymierne $\frac{f}{1}$
\end{fact}

\begin{remark}
Wyrażenia wielomianowe nad krzywą eliptyczną
będziemy odtąd utożsamiać z odpowiadającymi im wyrażeniami wymiernymi.
\end{remark}

Podobnie jak wyrażenia wielomianowe,
wyrażenia wymierne są klasami abstrakcji pewnej relacji równoważności,
co nie jest wygodne.

\begin{theorem}
Niech $r$ będzie wyrażeniem wymiernym nad krzywą eliptyczną $E(\K)$.
Wówczas istnieją wyrażenia wymierne $u, v \in \K(x)$ takie,
że $r = u + yv$.
Wyrażenia te są wyznaczone jednoznacznie.
\end{theorem}

\begin{remark}
Ciało funkcji wymiernych nad krzywą eliptyczną $E(\K)$
będziemy odtąd utożsamiać ze zbiorem
złożonym z wyrażeń wymiernych postaci $u + yv$,
gdzie $u,v \in \K(x)$.
Zbiór ten będziemy oznaczać $(1 + y)\K(x)$.
\end{remark}

Podobnie jak w przypadku zbioru $(1 + y)\K[x]$,
zbiór $(1 + y)\K(x)$ nie ma struktury ciała,
ale zawsze albo będą dane parametry krzywej eliptycznej,
albo w miejsce powstałego podczas mnożenia lub dzielenia czynnika $y^2$
będziemy podstawiać symbol $\kappa$.

Wyrażenia wymierne będziemy również przedstawiać w postaci ilorazu
elementów zbioru $(1 + y)\K[x]$.

\begin{theorem}
Dane jest wyrażenie wymierne $r$ nad krzywą eliptyczną $E(\K)$.
Wówczas $r = \frac{f}{g}$,
gdzie $f$ i $g$ to wyrażenia wielomianowe nad krzywą $E(\K)$ takie,
że $f = u_1 + yv_1$ oraz $g = u_2 + yv_2$,
gdzie $u_1, v_1, u_2, v_2 \in \K$.
\end{theorem}

\subsection*{Funkcje wielomianowe i wymierne}

Wyrażenia wielomianowe wyznaczają funkcje wielomianowe,
a wyrażenia wymierne -- funkcje wymierne.
Wyrażenia i funkcje wielomianowe będziemy określać
wspólnym mianem \emph{wielomian}.
W przypadku wyrażeń i funkcji wymiernych nie ma trzeciego określenia,
którym można by je wspólnie nazwać,
będziemy więc posługiwać się określeniem \emph{funkcje wymierne}.

\begin{remark}
Funkcję wymierną wyznaczoną przez wyrażenie wymierne $r$
oznaczać będziemy $r(x, y)$,
gdzie $x$ oraz $y$ to współrzędne punktu skończonego krzywej,
lub $r(P)$, gdzie $P$ to punkt skończony krzywej.
\end{remark}

Jest jasne, jak na podstawie wyrażenia wymiernego
obliczyć wartość odpowiadającej mu funkcji wymiernej
w dowolnym punkcie skończonym krzywej.
Jedyna niejasność związana jest z ewentualnym dzieleniem przez zero.

\begin{definition}
Dana jest funkcja wymierna $r$ nad krzywą eliptyczną
oraz punkt $P$ na tej krzywej.
Jeżeli istnieje taka reprezentacja $\frac{f}{g}$ funkcji $r$
że $f(P) \neq 0$ oraz $g(P) = 0$,
to mówimy, że funkcja wymierna $r$ ma w punkcie $P$
wartość \emph{nieskończoną},
co zapisujemy $r(P) = \infty$.
\end{definition}

\begin{theorem}
Dana jest funkcja wymierna $r = \frac{f}{g}$ nad krzywą eliptyczną $E$.
Jeżeli $P$ jest punktem skończonym krzywej $E$ oraz $r(P) = \infty$,
to $g(P) = 0$ niezależnie od reprezentacji $\frac{f}{g}$.
\end{theorem}

\subsection*{Sprzężenie i norma}

Następujące dwa pojęcia są bardzo przydatne,
ponieważ pozwalają sprowadzić
zagadnienie dotyczące wielomianów i funkcji wymiernych nad krzywą eliptyczną
do przypadku wyrażeń jednej zmiennej.

\begin{definition}
Dana jest funkcja wymierna $r = u + yv$ nad krzywą eliptyczną.
\emph{Funkcja wymierna sprzężona do funkcji $f$}
to funkcja $\overline{r} = u - yv$.
\end{definition}

\begin{definition}
Dana jest funkcja wymierna $r = u + yv$ nad krzywą eliptyczną.
\emph{Norma funkcji wymiernej $r$}
to funkcja wymierna $N(r) = r\overline{r} = u^2 - \kappa v^2$.
\end{definition}

\begin{fact}
Dane są funkcje wymierne $r$ oraz $s$ nad krzywą eliptyczną.
Wówczas $\overline{rs} = \overline{r}\,\overline{s}$
oraz $N(rs) = N(r)N(s)$.
\end{fact}

\subsection*{Stopień wielomianu i funkcji wymiernej}

Przyjmujemy następującą definicję stopnia wielomianu nad krzywą eliptyczną.

\begin{definition}
Dany jest wielomian $f$ nad krzywą eliptyczną.
\emph{Stopień wielomianu $f$},
oznaczany $\deg(f)$,
to stopień jego normy $N(f)$ traktowanej jak wielomian jednej zmiennej.
\end{definition}

Sens tej definicji jest następujący. Stopień wielomianu jednej zmiennej
to po prostu wykładnik najwyższej potęgi, w której występuje ta zmienna.
Podobnie rzecz ma się z wielomianami dwóch zmiennych.
Tę koncepcję przenosimy na wielomiany nad krzywą eliptyczną,
ale w taki sposób, żeby uwzględnić równanie krzywej.
Dlatego zmiennej $x$ przypisujemy stopień $2$,
a zmiennej $y$ -- stopień $3$.
Nieprzypadkowo, stopień liczony w ten sposób
jest równy stopniowi normy.

\begin{remark}
Aby uniknąć nieporozumień,
zwykły stopień wielomianu względem zmiennej $x$
oznaczać będziemy przez $\deg_x$.
\end{remark}

\begin{fact}
Niech $f = u + yv$ będzie wielomianem nad krzywą eliptyczną.
Wówczas $\deg(f) = \max(2\deg_x(u), 3 + 2\deg_x(v))$.
\end{fact}

Dysponując stopniem wielomianu, możemy określić stopień funkcji wymiernej.

\begin{definition}
Dana jest funkcja wymierna $r = \frac{f}{g}$ nad krzywą eliptyczną.
\emph{Stopień funkcji wymiernej $r$},
oznaczany $\deg(r)$,
to różnica $\deg(f) - \deg(g)$.
\end{definition}

Na stopnie wielomianów i funkcji wymiernych nad krzywą eliptyczną
przenosi się zasadnicza własność znana z teorii wyrażeń jednej zmiennej.

\begin{theorem}
Niech $r$ oraz $s$ będą dwoma funkcjami wymiernymi nad krzywą eliptyczną.
Wówczas $\deg(rs) = \deg(r) + \deg(s)$.
Ponadto, jeśli funkcja $s$ nie jest tożsamościowo równa zero,
to $\deg(\frac{r}{s}) = \deg(r) - \deg(s)$
oraz $\deg(\frac{1}{s}) = -\deg(s)$.
\end{theorem}

\subsection*{Wartość funkcji wymiernej w punkcie w nieskończoności}

Chcemy określić wartość funkcji wymiernej (zatem także wielomianu)
w punkcie w nieskończoności.
W przypadku funkcji wymiernych nad ciałem liczb rzeczywistych
obliczamy po prostu granicę wartości funkcji,
gdy argument dąży do nieskończoności.
Następująca definicja określa
wartość funkcji wymiernej w punkcie w nieskończoności w sposób,
który ma wiele cech wspólnych ze wspomnianym przejściem granicznym.

\begin{definition}
Dana jest funkcja wymierna $r$ nad krzywą eliptyczną.
Wartość funkcji $r$ w punkcie w nieskończoności $\ecident$
ustalamy następująco:
\begin{itemize}
\item jeżeli $\deg(r) < 0$, to $r(\ecident) = 0$;
\item jeżeli $\deg(r) > 0$, to $r(\ecident) = \infty$;
\item jeżeli $\deg(r) = 0$,
to przedstawiamy funkcję $r$ w postaci $\frac{f}{g}$,
gdzie $f = u_1 + yv_1$ oraz $g = u_2 + yv_2$
i wówczas:
\begin{itemize}
\item stopnie wielomianów $f$ i $g$ są parzyste,
ich wiodące składniki mają postać odpowiednio $ax^d$ i $bx^d$,
wówczas $r(\ecident) = \frac{a}{b}$;
\item stopnie wielomianów $f$ i $g$ są nieparzyste,
ich wiodące składniki mają postać odpowiednio $ayx^d$ i $byx^d$,
wówczas również $r(\ecident) = \frac{a}{b}$.
\end{itemize}
\end{itemize}
\end{definition}

Pod wieloma względami funkcje wymierne zachowują się
w punkcie $\ecident$ i punktach skończonych podobnie,
co pokazuje następujące twierdzenie.

\begin{theorem}
Dane są dwie funkcje wymierne $r$ oraz $s$ takie,
że $r(\ecident) \neq \infty$ oraz $s(\ecident) \neq \infty$.
Wówczas $(r \pm s)(\ecident) = r(\ecident) \pm s(\ecident)$
oraz $(rs)(\ecident) = r(\ecident)s(\ecident)$.
Co więcej, jeśli $s(\ecident) \neq 0$,
to $(\frac{r}{s})(\ecident) = \frac{r(\ecident)}{s(\ecident)}$.
\end{theorem}

\subsection*{Miejsca zerowe i bieguny}

Przyjmujemy następującą definicję
miejsca zerowego oraz bieguna funkcji wymiernej nad krzywą eliptyczną.

\begin{definition}
Dana jest funkcja wymierna $r$ nad krzywą eliptyczną.
\emph{Miejsce zerowe funkcji $r$} (odpowiednio, \emph{biegun funkcji $f$})
to taki punkt $P$ krzywej, że $r(P) = 0$ (odpowiednio, $r(P) = \infty$).
\end{definition}

\begin{fact}
Jeżeli punkt $P$ jest miejscem zerowym (biegunem) funkcji wymiernej $r$,
to punkt $\overline{P}$ jest miejscem zerowym funkcji wymiernej $\overline{r}$.
\end{fact}

\begin{fact}\label{zero_of_norm_fact}
Punkt $P = (a, b)$ jest miejscem zerowym wielomianu $f$ wtedy i tylko wtedy,
gdy liczba $a$ jest miejscem zerowym wielomianu $N(f)$.
\end{fact}

\begin{fact}
Punkty rzędu dwa na krzywej eliptycznej
to miejsca zerowe wielomianu charakterystycznego $\kappa$ tej krzywej.
Niezdegenerowana krzywa eliptyczna nad ciałem algebraicznie domkniętym
ma dokładnie trzy punkty rzędu dwa.
\end{fact}

Podczas badania miejsc zerowych i biegunów
funkcji wymiernych nad krzywą eliptyczną
będziemy chcieli uwolnić się od konieczności pilnowania,
czy ciało, nad którym zdefiniowana jest krzywa,
jest algebraicznie domknięte czy nie.

\begin{fact}
Jeżeli dane są dwa ciała $\K$ i $\fieldL$ takie, że $\K \subset \fieldL$
oraz parametry $A,B \in \K$,
to $E_{A,B}(\K) \subset E_{A,B}(\fieldL)$.
\end{fact}

Fakt ten pozwala nam uwolnić się od pytania,
czy ciało $\K$ jest algebraicznie domknięte --
rozważania na temat krzywej nad ciałem $\K$
zawsze możemy potraktować
jak rozważania na temat krzywej o tych samych parametrach
nad większym ciałem $\fieldL = \overline{\K}$.

\begin{definition}
Dane są dwa ciała $\K \subset \fieldL$ oraz parametry $A, B \in \K$.
Punkty krzywej eliptycznej $E_{A,B}(\K)$
nazywamy \emph{punktami $\K$-wymiernymi na krzywej $E_{A,B}(\fieldL)$}.
\end{definition}

\begin{remark}
Do końca tego rozdziału przyjmujemy,
że ciało $\K$, nad którym rozpatrujemy krzywe eliptyczne,
jest algebraicznie domknięte.
\end{remark}

Podobnie jak w przypadku funkcji wymiernych jednej zmiennej,
chcemy wprowadzić pojęcie krotności miejsca zerowego i bieguna.

\begin{theorem}\label{uniformizer_existence_theorem}
Dla każdego punktu $P = (a, b)$ na krzywej eliptycznej
istnieje funkcja wymierna $u$ taka, że $u(P) = 0$
oraz każdą funkcję wymierną $r$ można zapisać w postaci $r = u^ds$,
gdzie $d \in \Z$ oraz $s$ jest funkcją wymierną taką, że $s(P) \neq 0$.

Przykładowymi funkcjami, które spełniają powyższy warunek, są:
\begin{itemize}
\item dla punktów rzędu dwa $u(x, y) = y$;
\item dla pozostałych punktów skończonych $u(x, y) = x - a$;
\item dla punktu w nieskończoności $u(x, y) = \frac{y}{x}$.
\end{itemize}

Wartość wykładnika $d$ nie zależy od wyboru funkcji $u$.
\end{theorem}

Twierdzenie to ukazuje pewną wspólną cechę
funkcji wymiernych nad krzywą eliptyczną
oraz zwykłych funkcji wymiernych,
dzięki czemu może posłużyć przeniesienia na krzywe eliptyczne
pojęcia krotności miejsca zerowego lub bieguna.

\begin{definition}
Dany jest punkt $P$ na krzywej eliptycznej.
\emph{Unifikator w punkcie $P$}
to dowolna funkcja wymierna $u$
spełniająca warunki podane w twierdzeniu \ref{uniformizer_existence_theorem}.
\end{definition}

\begin{definition}
Dana jest funkcja wymierna $r$ nad krzywą eliptyczną,
punkt $P$ na tej krzywej oraz unifikator $u$ w tym punkcie.
\emph{Rząd funkcji $r$ w punkcie $P$},
oznaczany $\ord_P(r)$,
to taka liczba całkowita $d$,
że $r = u^ds$, gdzie $s(P) \neq 0$.
Dodatkowo:
\begin{itemize}
\item jeżeli $d = 0$,
to funkcja $r$ nie ma w punkcie $P$ ani miejsca zerowego, ani bieguna;
\item jeżeli $d > 0$, to mówimy,
że \emph{funkcja $r$ ma w punkcie $P$ $d$-krotne miejsce zerowe};
\item jeżeli $d < 0$, to mówimy,
że \emph{funkcja $r$ ma w punkcie $P$ $\abs{d}$-krotny biegun}.
\end{itemize}
\end{definition}

Możemy teraz wyrazić szereg ważnych własności
wielomianów i funkcji wymiernych.

\begin{theorem}
Dany jest wielomian $f$ nad krzywą eliptyczną $E$.
Wówczas
\begin{equation*}
\sum_{P \in E\setminus \{\ecident\}} \ord_P(f) = \deg(f)
\end{equation*}
\end{theorem}

\begin{corollary}\label{function_order_sum_zero_corollary}
Dana jest funkcja wymierna $r$ nad krzywą eliptyczną $E$. Wówczas
\begin{equation*}
\sum_{P \in E} \ord_P(r) = 0
\end{equation*}
\end{corollary}

\begin{corollary}
Ilość punktów, w których funkcja wymierna ma miejsce zerowe lub biegun,
jest skończona.
\end{corollary}

\begin{corollary}
Krotność dowolnego miejsca zerowego lub bieguna funkcji wymiernej
jest skończona.
\end{corollary}

Ze względu na definicję stopnia wielomianu
możemy jeszcze wysnuć następujący wniosek.

\begin{corollary}\label{poly_no_single_zero_corollary}
Wielomian nie może mieć stopnia równego $1$,
zatem nie może mieć jednego jednokrotnego miejsca zerowego.
\end{corollary}
