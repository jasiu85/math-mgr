\section{Wielomiany i funkcje wymierne}

Nasze rozważania w dalszej części pracy
będą często dotyczyć
wielomianów i funkcji wymiernych na krzywych eliptycznych,
dlatego też przeanalizujemy teraz te pojęcia.
Wykazują one podobieństwo do wielomianów i funkcji wymiernych jednej zmiennej,
są też pewne różnice.

\subsection*{Definicja wyrażenia wielomianowego}

Przyjmujemy następującą definicję
wyrażenia wielomianowego na krzywej eliptycznej.

\begin{definition}
Dana jest krzywa eliptyczna $E = E(\K)$.
\emph{Wyrażenie wielomianowe na krzywej $E$}
to element pierścienia ilorazowego
$\K[x,y]/(\kappa(E) - y^2)$.
Pierścień wszystkich wyrażeń wielomianowych na krzywej $E$
oznaczamy symbolem $\K[E]$.
\end{definition}

Sens powyższej definicji jest następujący.
Dowolna krzywa eliptyczna nad ciałem $\K$ to podzbiór zbioru $\K \times \K$
(nie licząc punktu w nieskończoności),
dlatego pierwszym kandydatem na pierścień wyrażeń wielomianowych
jest pierścień $\K[x,y]$.
Współrzędne skończonych punktów krzywej spełniają równanie krzywej,
dlatego też wielomiany dwóch zmiennych różniące się
o wielokrotność wielomianu $\kappa- y^2$
dadzą tę samą funkcję wielomianową,
niezależnie od wyboru ciała $\K$.
Stąd pierścień $\K[x,y]$ dzielimy przez ideał $(\kappa- y^2)$
i uzyskujemy pierścień ilorazowy $K[x,y]/(\kappa - y^2)$.

Wyrażenie wielomianowe na krzywej eliptycznej
jest w takim razie klasą abstrakcji
pewnej relacji równoważności na zbiorze wielomianów dwóch zmiennych.
Nie jest wygodnie myśleć o wyrażeniach wielomianowych w ten sposób.
Następujący lemat pokazuje,
w jaki sposób wybrać reprezentantów klas abstrakcji
do dalszych rozważań.

\begin{theorem}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz wyrażenie wielomianowe $f \in \K[E]$.
Wówczas istnieją wyrażenia wielomianowe $u, v \in \K[x]$ takie,
że $f = u + yv$.
Wyrażenia $u$ i $v$ są wyznaczone jednoznacznie.
\end{theorem}

\begin{remark}
Zbiór wyrażeń wielomianowych na krzywej eliptycznej $E(\K)$
będziemy odtąd utożsamiać ze zbiorem
złożonym z wielomianów postaci $u + yv$,
gdzie $u, v \in \K[x]$.
Zbiór ten będziemy oznaczać $(1 + y)\K[x]$.
\end{remark}

Zwróćmy uwagę, że zbiór $(1 + y)\K[x]$ nie ma struktury pierścienia,
ponieważ nie jest określone mnożenie.
Nie jest to problem,
ponieważ z kontekstu zawsze będzie wynikało,
na jakiej krzywej rozpatrywane są wyrażenia wielomianowe.
Co więcej, czasami wystarczy,
że w miejsce powstałego podczas mnożenia czynnika $y^2$
będziemy podstawiać symbol $\kappa$
i nie będzie nam potrzebna dokładna znajomość parametrów $A$ i $B$ krzywej.

\begin{remark}
W zależności od kontekstu wielomian charakterystyczny krzywej eliptycznej
będziemy traktować jak wielomian jednej zmiennej, wielomian dwóch zmiennych
lub jak wyrażenie wielomianowe na krzywej eliptycznej.
\end{remark}

\subsection*{Definicja wyrażenia wymiernego}

Przyjmujemy następującą definicję
wyrażenia wymiernego na krzywej eliptycznej.

\begin{definition}
Dana jest krzywa eliptyczna $E = E(\K)$.
\emph{Wyrażenie wymierne na krzywej $E$}
to element ciała ułamków
pierścienia wyrażeń wielomianowych na tej krzywej, $E[\K]$.
Ciało wszystkich wyrażeń wymiernych na krzywej $E$
oznaczamy symbolem $\K(E)$.
\end{definition}

Sens tej definicji jest taki sam,
jak w przypadku każdego innego ciała ułamków --
bierzemy zbiór ułamków formalnych $\frac{f}{g}$,
gdzie $f$ i $g$ to wyrażenia wielomianowe na krzywej eliptycznej,
po czym utożsamiamy ułamki $\frac{f_1}{g_1}$ oraz $\frac{f_2}{g_2}$,
jeżeli zachodzi równość wyrażeń $f_1g_2 = f_2g_1$.

\begin{fact}
Zbiór wyrażeń wielomianowych na krzywej eliptycznej $E$
można zanurzyć w zbiór wyrażeń wymiernych na tej krzywej,
przypisując wyrażeniu wielomianowemu $f$ wyrażenie wymierne $\frac{f}{1}$
\end{fact}

\begin{remark}
Wyrażenia wielomianowe na krzywej eliptycznej
będziemy odtąd utożsamiać z odpowiadającymi im wyrażeniami wymiernymi.
\end{remark}

Podobnie jak wyrażenia wielomianowe,
wyrażenia wymierne są klasami abstrakcji pewnej relacji równoważności,
co nie jest wygodne.

\begin{theorem}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz wyrażenie wymierne $r \in \K(E)$.
Wówczas istnieją wyrażenia wymierne $u, v \in \K(x)$ takie,
że $r = u + yv$.
Wyrażenia $u$ i $v$ są wyznaczone jednoznacznie.
\end{theorem}

\begin{remark}
Zbiór wyrażeń wymiernych na krzywej eliptycznej $E(\K)$
będziemy odtąd utożsamiać ze zbiorem
złożonym z wyrażeń wymiernych postaci $u + yv$,
gdzie $u,v \in \K(x)$.
Zbiór ten będziemy oznaczać $(1 + y)\K(x)$.
\end{remark}

Podobnie jak w przypadku zbioru $(1 + y)\K[x]$,
zbiór $(1 + y)\K(x)$ nie ma struktury ciała --
nie można mnożyć ani dzielić.
Jednak zawsze albo będą dane parametry krzywej eliptycznej,
albo w miejsce powstałego podczas mnożenia lub dzielenia czynnika $y^2$
będziemy podstawiać symbol $\kappa$.

Wyrażenia wymierne możemy również przedstawiać w postaci ilorazu
elementów zbioru $(1 + y)\K[x]$.

\begin{theorem}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz wyrażenie wymierne $r \in \K(E)$.
Wówczas istnieją wyrażenia wielomianowe $f, g \in (1 + y)\K[x]$ takie,
że $r = \frac{f}{g}$.
\end{theorem}

\subsection*{Funkcje wielomianowe i wymierne}

Wyrażenia wielomianowe wyznaczają funkcje wielomianowe,
a wyrażenia wymierne -- funkcje wymierne.
Wyrażenia i funkcje wielomianowe będziemy określać
wspólnym mianem \emph{wielomian}.
W przypadku wyrażeń i funkcji wymiernych nie ma trzeciego określenia,
którym można by je wspólnie nazwać,
będziemy więc posługiwać się określeniem \emph{funkcje wymierne}.

\begin{remark}
Funkcję wymierną wyznaczoną przez wyrażenie wymierne $r$
oznaczać będziemy symbolem $r(x, y)$,
gdzie $x$ oraz $y$ to współrzędne punktu skończonego krzywej,
lub symbolem $r(P)$, gdzie $P$ to punkt skończony krzywej.
\end{remark}

Jest jasne, jak na podstawie wyrażenia wymiernego
obliczyć wartość odpowiadającej mu funkcji wymiernej
w dowolnym punkcie skończonym krzywej.
Jedyna ewentualna trudność pojawia się,
gdy wartość licznika lub mianownika jest równa zero.

\begin{definition}
Dana jest krzywa eliptyczna $E = E(\K)$,
funkcja wymierna $r \in \K(E)$
oraz punkt skończony $P \in E$.
Jeżeli istnieją takie wielomiany $f, g \in \K[E]$ takie,
że $r = \frac{f}{g}$, $f(P) \neq 0$ oraz $g(P) = 0$,
to mówimy,
że \emph{funkcja wymierna $r$ ma w punkcie $P$ wartość nieskończoną},
co zapisujemy $r(P) = \infty$.
\end{definition}

\begin{theorem}
Dana jest krzywa eliptyczna $E = E(\K)$,
funkcja wymierna $r \in \K(E)$, $r = \frac{f}{g}$
oraz punkt skończony $P \in E$.
Jeżeli $r(P) = 0$, 
to $f(P) = 0$ niezależnie od wyboru wielomianów $f$ i $g$.
\end{theorem}

\begin{theorem}
Dana jest krzywa eliptyczna $E = E(\K)$,
funkcja wymierna $r \in \K(E)$, $r = \frac{f}{g}$
oraz punkt skończony $P \in E$.
Jeżeli $r(P) = \infty$, 
to $g(P) = 0$ niezależnie od wyboru wielomianów $f$ i $g$.
\end{theorem}

\subsection*{Sprzężenie i norma}

Następujące dwa pojęcia są bardzo przydatne,
ponieważ pozwalają sprowadzić
zagadnienie dotyczące wielomianów i funkcji wymiernych na krzywej eliptycznej
do przypadku wyrażeń jednej zmiennej.

\begin{definition}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz funkcja wymierna $r \in \K(E)$, $r = u + yv$.
\emph{Funkcja wymierna sprzężona do funkcji $r$}
to funkcja wymierna $\overline{r} = u - yv$.
\end{definition}

\begin{definition}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz funkcja wymierna $r \in \K(E)$, $r = u + yv$.
\emph{Norma funkcji wymiernej $r$}
to funkcja wymierna $N(r) = r\overline{r} = u^2 - \kappa v^2$.
\end{definition}

\begin{fact}
Dana jest krzywa eliptyczna $E$
oraz funkcje wymierne $r$ i $s$ na tej krzywej.
Wówczas $\overline{rs} = \overline{r}\,\overline{s}$
oraz $N(rs) = N(r)N(s)$.
\end{fact}

\subsection*{Stopień wielomianu i funkcji wymiernej}

Przyjmujemy następującą definicję stopnia wielomianu na krzywej eliptycznej.

\begin{definition}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz wielomian $f \in \K[E]$.
\emph{Stopień wielomianu $f$},
oznaczany symbolem $\deg(f)$,
to stopień jego normy $N(f)$ traktowanej jak wielomian jednej zmiennej.
\end{definition}

Sens tej definicji jest następujący.
W przypadku wielomianów jednej zmiennej $x$
przypisujemy jej stopień $1$,
po czym stopień wszystkich wielomianów ustalamy mając na uwadze fakt,
że stopień iloczynu to suma stopni.
Tę koncepcję przenosimy na wielomiany na krzywej eliptycznej,
ale w taki sposób, żeby uwzględnić równanie krzywej.
Dlatego zmiennej $x$ przypisujemy stopień $2$,
a zmiennej $y$ -- stopień $3$.
Ponadto, do obliczania stopnia wielomianu $f$
wybieramy reprezentanta klasy abstrakcji $f$ w postaci $u + yv$.

\begin{remark}
Aby uniknąć nieporozumień,
stopień wielomianu jednej zmiennej $x$
oznaczać będziemy symbolem $\deg_x$.
\end{remark}

\begin{fact}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz wielomian $f \in \K[E]$, $f = u + yv$.
Wówczas $\deg(f) = \max(2\deg_x(u), 3 + 2\deg_x(v))$.
\end{fact}

Dysponując stopniem wielomianu, możemy określić stopień funkcji wymiernej.

\begin{definition}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz funkcja wymierna $r \in \K(E)$, $r = \frac{f}{g}$.
\emph{Stopień funkcji wymiernej $r$},
oznaczany symbolem $\deg(r)$,
to wielkość $\deg(f) - \deg(g)$.
\end{definition}

\begin{theorem}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz funkcja wymierna $r \in \K(E)$.
Wówczas stopień funkcji $r$ jest dobrze określony,
tzn. dla dowolnych wielomianów $f_1, g_1, f_2, g_2 \in \K[E]$ takich,
że $\frac{f_1}{g_1} = r = \frac{f_2}{g_2}$,
zachodzi $\deg(f_1) - \deg(g_1) = \deg(f_2) - \deg(g_2)$.
\end{theorem}

Na stopnie wielomianów i funkcji wymiernych na krzywej eliptycznej
przenosi się zasadnicza własność znana z teorii wyrażeń jednej zmiennej.

\begin{theorem}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz funkcje wymierne $r, s \in \K(E)$.
Wówczas $\deg(rs) = \deg(r) + \deg(s)$.
\end{theorem}

\subsection*{Wartość funkcji wymiernej w punkcie w nieskończoności}

Chcemy określić wartość funkcji wymiernej (zatem także wielomianu)
w punkcie w nieskończoności.
W przypadku funkcji wymiernych nad ciałem liczb rzeczywistych
obliczamy po prostu granicę wartości funkcji,
gdy argument dąży do nieskończoności.
Uzyskana w ten sposób wartość, jeśli jest skończona,
jest po prostu ilorazem współczynników stojących przy najwyższych potęgach
w mianowniku i liczniku.
Dzięki tej obserwacji możemy w analogiczny sposób określić
wartość funkcji wymiernej w punkcie w nieskończoności.

\begin{definition}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz funkcja wymierna $r \in \K(E)$.
Wartość funkcji $r$ w punkcie $\ecident$
ustalamy następująco:
\begin{itemize}
\item jeżeli $\deg(r) < 0$, to $r(\ecident) = 0$;
\item jeżeli $\deg(r) > 0$, to $r(\ecident) = \infty$;
\item jeżeli $\deg(r) = 0$,
to przedstawiamy funkcję $r$ w postaci $\frac{f}{g}$ i wówczas:
\begin{itemize}
\item jeżeli stopnie wielomianów $f$ i $g$ są parzyste,
to ich wiodące składniki mają postać odpowiednio $ax^d$ i $bx^d$,
wówczas $r(\ecident) = \frac{a}{b}$;
\item jeżeli stopnie wielomianów $f$ i $g$ są nieparzyste,
to ich wiodące składniki mają postać odpowiednio $ayx^d$ i $byx^d$,
wówczas również $r(\ecident) = \frac{a}{b}$.
\end{itemize}
\end{itemize}
\end{definition}

Pod wieloma względami funkcje wymierne zachowują się
w punkcie $\ecident$ i punktach skończonych podobnie,
co pokazuje następujące twierdzenie.

\begin{theorem}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz funkcje wymierne $r, s \in \K(E)$.
Jeżeli $r(\ecident) \neq \infty$ oraz $s(\ecident) \neq \infty$,
to $(r + s)(\ecident) = r(\ecident) + s(\ecident)$
oraz $(rs)(\ecident) = r(\ecident)s(\ecident)$.
\end{theorem}

\subsection*{Miejsca zerowe i bieguny}

Przyjmujemy następującą definicję
miejsca zerowego oraz bieguna funkcji wymiernej na krzywej eliptycznej.

\begin{definition}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz funkcja wymierna $r \in \K(E)$.
\emph{Miejsce zerowe funkcji $r$} (odpowiednio, \emph{biegun funkcji $r$})
to taki punkt $P \in E$, że $r(P) = 0$ (odpowiednio, $r(P) = \infty$).
\end{definition}

\begin{fact}
Jeżeli punkt $P$
jest miejscem zerowym (biegunem) funkcji wymiernej $r$,
to punkt $\overline{P}$
jest miejscem zerowym (biegunem) funkcji wymiernej $\overline{r}$.
\end{fact}

\begin{corollary}\label{zero_of_norm_coro}
Jeżeli punkt $P = (a, b)$ jest miejscem zerowym wielomianu $f$,
to wartość $a$ jest miejscem zerowym wielomianu $N(f)$.
\end{corollary}

\begin{fact}
Punkty rzędu dwa na krzywej eliptycznej
to miejsca zerowe wielomianu charakterystycznego tej krzywej.
Niezdegenerowana krzywa eliptyczna nad ciałem algebraicznie domkniętym
ma dokładnie trzy punkty rzędu dwa.
\end{fact}

Podczas badania miejsc zerowych i biegunów
funkcji wymiernych na krzywej eliptycznej
będziemy chcieli uwolnić się od konieczności pilnowania,
czy ciało, nad którym zdefiniowana jest krzywa,
jest algebraicznie domknięte czy nie.

\begin{fact}
Dane są dwa ciała $\K$ i $\fieldL$ takie, że $\K \subset \fieldL$
oraz parametry $A,B \in \K$.
Wówczas $E_{A,B}(\K) \subset E_{A,B}(\fieldL)$.
\end{fact}

Fakt ten pozwala nam uwolnić się od pytania,
czy ciało $\K$ jest algebraicznie domknięte --
rozważania na temat krzywej nad ciałem $\K$
zawsze możemy potraktować
jak rozważania na temat krzywej o tych samych parametrach
nad większym ciałem $\fieldL = \overline{\K}$.

\begin{definition}
Dane są dwa ciała $\K \subset \fieldL$ oraz parametry $A, B \in \K$.
Punkty krzywej eliptycznej $E_{A,B}(\K)$
nazywamy \emph{punktami $\K$-wymiernymi na krzywej $E_{A,B}(\fieldL)$}.
\end{definition}

\begin{remark}
Do końca tego rozdziału przyjmujemy,
że rozpatrywane krzywe są określone nad ciałami algebraicznie domkniętymi.
\end{remark}

Podobnie jak w przypadku funkcji wymiernych jednej zmiennej,
chcemy wprowadzić pojęcie krotności miejsca zerowego i bieguna.

\begin{theorem}\label{uniformizer_existence_theorem}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz punkt $P \in E$.
Wówczas istnieje funkcja wymierna $u \in \K(E)$ taka, że $u(P) = 0$
oraz dla każdej funkcji wymiernej $r \in \K(E)$
istnieje liczba całowita $d \in \Z$
oraz funkcja wymierna $s \in \K(E)$, $s(P) \neq 0$ taka,
że zachodzi następująca równość:
\begin{equation}\label{uniformizer_decomposition_eqn}
r = u^ds
\end{equation}
Liczba $d$ nie zależy od wyboru funkcji $u$.

Przykładowymi funkcjami, które spełniają powyższy warunek, są:
\begin{itemize}
\item jeżeli $P = (a, 0)$, to $u(x, y) = y$;
\item jeżeli $P = (a, b)$, gdzie $b \neq 0$, to $u(x, y) = x - a$;
\item jeżeli $P = \ecident$, to $u(x, y) = \frac{y}{x}$.
\end{itemize}
\end{theorem}

Twierdzenie to ukazuje pewną wspólną cechę
funkcji wymiernych na krzywej eliptycznej
oraz zwykłych funkcji wymiernych,
dzięki czemu może posłużyć do przeniesienia na krzywe eliptyczne
pojęcia krotności miejsca zerowego lub bieguna.

\begin{definition}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz punkt $P \in E$.
\emph{Unifikator w punkcie $P$}
to dowolna funkcja wymierna $u \in \K(E)$
spełniająca warunki podane w twierdzeniu \ref{uniformizer_existence_theorem}.
\end{definition}

\begin{definition}
Dana jest krzywa eliptyczna $E = E(\K)$,
punkt $P \in E$,
unifikator $u$ w punkcie $P$
oraz funkcja wymierna $r \in \K(E)$.
\emph{Rząd funkcji $r$ w punkcie $P$},
oznaczany symbolem $\ord_P(r)$,
to liczba całkowita $d$
występująca w równości \ref{uniformizer_decomposition_eqn}.
Ponadto:
\begin{itemize}
\item jeżeli $d = 0$,
to funkcja $r$ nie ma w punkcie $P$ ani miejsca zerowego, ani bieguna;
\item jeżeli $d > 0$, to mówimy,
że \emph{funkcja $r$ ma w punkcie $P$ $d$-krotne miejsce zerowe};
\item jeżeli $d < 0$, to mówimy,
że \emph{funkcja $r$ ma w punkcie $P$ $\abs{d}$-krotny biegun}.
\end{itemize}
\end{definition}

Możemy teraz wyrazić szereg ważnych własności
wielomianów i funkcji wymiernych na krzywej eliptycznej
związanych z miejscami zerowymi i biegunami.

\begin{theorem}\label{polynomial_ord_deg_theorem}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz wielomian $f \in \K[E]$.
Wówczas:
\begin{equation*}
\sum_{P \in E\setminus \{\ecident\}} \ord_P(f) = \deg(f)
\end{equation*}
\end{theorem}

\begin{corollary}\label{function_order_sum_zero_corollary}
Dana jest krzywa eliptyczna $E = E(\K)$
oraz funkcja wymierna $r \in \K(E)$.
Wówczas:
\begin{equation*}
\sum_{P \in E} \ord_P(r) = 0
\end{equation*}
\end{corollary}

\begin{corollary}
Funkcja wymierna na krzywej eliptycznej ma miejsce zerowe lub biegun
w skończonej liczbie punktów.
\end{corollary}

\begin{corollary}
Krotność każdego miejsca zerowego lub bieguna
funkcji wymiernej na krzywej eliptycznej
jest skończona.
\end{corollary}

Ze względu na definicję stopnia wielomianu na krzywej eliptycznej
możemy jeszcze wysnuć następujący wniosek.

\begin{corollary}\label{poly_no_single_zero_corollary}
Wielomian ma krzywej eliptycznje nie może mieć stopnia równego $1$,
zatem nie może mieć jednego jednokrotnego miejsca zerowego.
\end{corollary}
